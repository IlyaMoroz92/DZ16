<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DZ16</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://unpkg.com/dayjs@1.8.21/dayjs.min.js"></script>

</head>
<body>
    <canvas id="canvas"></canvas>
    <current-kurs></current-kurs>

    <script>
    class Kurs extends HTMLElement { 

    connectedCallback() {
        
        let today = dayjs().format().slice(0, 10)
        let yesterday = dayjs().subtract(1, 'day').format().slice(0, 10)
        
        function getKurs() {

        fetch(`https://www.nbrb.by/api/exrates/rates/dynamics/451?startdate=${yesterday}&enddate=${today}`)
        .then((response) => response.json()) 
        .then(function aaa(json) {  
        for(let i=0; i<json.length; i++) {
        createTr(`${json[i].Date.slice(0,10)}: 1 EUR `, `${json[i].Cur_OfficialRate} BYN`)
        }
        })

        fetch(`https://www.nbrb.by/api/exrates/rates/dynamics/431?startdate=${yesterday}&enddate=${today}`)
        .then((response) => response.json()) 
        .then(function aaa(json) {  
        for( let j=0; j<json.length; j++) {
        createTr(`${json[j].Date.slice(0,10)}: 1 USD `, `${json[j].Cur_OfficialRate} BYN`)
        }
        })
    }
    getKurs()

    function createTr (el1, el2) {
        const body = document.querySelector('body');
        const div = document.createElement('div');
        const table = document.createElement('table');
        const tr = document.createElement('tr');
        const td1 = document.createElement('td');
        const td2 = document.createElement('td');

        td1.innerText = el1;
        td2.innerText = el2;
        tr.appendChild(td1);
        tr.appendChild(td2);

        table.appendChild(tr);
        div.appendChild(table);
        body.appendChild(table);
        }
    }
    }

    customElements.define("current-kurs", Kurs);

    const canvas = document.getElementById("canvas");
    const logo = canvas.getContext("2d");
    logo.fillStyle = "red";
    logo.fillRect(10, 10, 100, 100);
    logo.font = "32px serif";
    logo.shadowColor = '#d53';
    logo.fontColor = '#d53';
    logo.strokeText("LOGO", 16, 70);

</script>
</body>
</html>
